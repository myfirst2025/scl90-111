<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCL-90症状自评量表测试 - 专业心理健康评估</title>
    <meta name="description" content="免费SCL-90症状自评量表测试，专业心理健康评估工具，帮助您了解自己的心理状态">
    <!-- 使用CDN加速 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Microsoft YaHei', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eaeaea;
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 2.2rem;
        }

        .instructions {
            background-color: #e8f4fc;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 5px solid #3498db;
        }

        .instructions h2 {
            color: #2980b9;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .instructions ul {
            padding-left: 20px;
            margin: 15px 0;
        }

        .instructions li {
            margin-bottom: 8px;
        }

        .question-container {
            margin-bottom: 25px;
        }

        .question {
            background-color: #f8f9fa;
            padding: 18px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #3498db;
            transition: transform 0.2s;
        }

        .question:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .question-number {
            font-weight: bold;
            margin-bottom: 10px;
            color: #2c3e50;
            font-size: 1.1rem;
        }

        .options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 12px;
        }

        .option {
            flex: 1;
            min-width: 120px;
        }

        .option label {
            display: block;
            padding: 10px 15px;
            background: #eef2f7;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-size: 0.95rem;
        }

        .option input[type="radio"] {
            display: none;
        }

        .option input[type="radio"]:checked + label {
            background: #3498db;
            color: white;
            box-shadow: 0 3px 8px rgba(52, 152, 219, 0.4);
        }

        .option label:hover {
            background: #d6e4f0;
        }

        .submit-btn {
            display: block;
            width: 100%;
            padding: 16px;
            background: #2c3e50;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background 0.3s;
            margin-top: 25px;
            font-weight: bold;
            letter-spacing: 1px;
        }

        .submit-btn:hover {
            background: #3498db;
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
        }

        #results {
            display: none;
            margin-top: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #eaeaea;
        }

        .results-header {
            text-align: center;
            margin-bottom: 25px;
            color: #2c3e50;
            font-size: 1.8rem;
        }

        .score-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .score-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            text-align: center;
        }

        .score-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #2c3e50;
            margin: 10px 0;
        }

        .score-label {
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            font-size: 0.9em;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }

        .results-table thead tr {
            background-color: #2c3e50;
            color: white;
            text-align: left;
            font-weight: bold;
        }

        .results-table th,
        .results-table td {
            padding: 12px 15px;
            text-align: center;
        }

        .results-table tbody tr {
            border-bottom: 1px solid #dddddd;
        }

        .results-table tbody tr:nth-of-type(even) {
            background-color: #f8f9fa;
        }

        .results-table tbody tr:last-of-type {
            border-bottom: 2px solid #2c3e50;
        }

        .score-low {
            background-color: #d4edda !important;
            color: #155724;
            font-weight: bold;
        }

        .score-moderate {
            background-color: #fff3cd !important;
            color: #856404;
            font-weight: bold;
        }

        .score-high {
            background-color: #f8d7da !important;
            color: #721c24;
            font-weight: bold;
        }

        .factor-details {
            margin-top: 30px;
        }

        .factor-explanation {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            margin-bottom: 20px;
        }

        .factor-explanation h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }

        .interpretation {
            background: #fff8e1;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            border-left: 5px solid #ffc107;
        }

        .interpretation h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            .options {
                flex-direction: column;
            }

            .option {
                width: 100%;
            }

            .option label {
                padding: 12px;
            }

            h1 {
                font-size: 1.8rem;
            }

            .results-table {
                display: block;
                overflow-x: auto;
            }

            .score-summary {
                grid-template-columns: 1fr;
            }
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            padding: 15px;
            background: #e8f4fc;
            border-radius: 8px;
            font-weight: bold;
        }

        .completion-message {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background: #e8f5e9;
            border-radius: 8px;
            color: #2e7d32;
            font-weight: bold;
            display: none;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #eaeaea;
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .print-btn {
            display: inline-block;
            padding: 10px 20px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 20px;
            font-weight: bold;
        }

        .print-btn:hover {
            background: #218838;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="bi bi-clipboard-heart"></i> SCL-90症状自评量表测试</h1>
            <p>以下列出了有些人可能会有的问题，请仔细阅读每一条，然后根据最近一星期以内您的实际感觉，选择最符合您情况的选项。</p>
        </header>

        <div class="instructions">
            <h2><i class="bi bi-info-circle"></i> 指导语</h2>
            <p>本量表包含90个项目，涉及感觉、情感、思维、意识、行为、生活习惯、人际关系、饮食睡眠等。请根据您最近一周的实际感受进行评分：</p>
            <ul>
                <li><strong>1分-没有</strong>：自觉无该项症状</li>
                <li><strong>2分-很轻</strong>：自觉有该项症状，但影响轻微</li>
                <li><strong>3分-中等</strong>：自觉有该项症状，程度为轻到中度</li>
                <li><strong>4分-偏重</strong>：自觉有该项症状，程度为中到严重</li>
                <li><strong>5分-严重</strong>：自觉有该项症状，程度十分严重</li>
            </ul>
            <p>请注意：本测试仅供参考，不能替代专业医疗诊断。如有严重心理困扰，请咨询专业心理医生。</p>
        </div>

        <div class="progress-info">
            <span><i class="bi bi-check-circle"></i> 完成进度: <span id="progress">0</span>/90</span>
            <span><i class="bi bi-clock"></i> 剩余: <span id="remaining">90</span>题</span>
        </div>

        <div class="completion-message" id="completion-message">
            <i class="bi bi-check-lg"></i> 您已完成所有题目，请点击下方按钮提交测试
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>正在计算测试结果，请稍候...</p>
        </div>

        <form id="scl90-test">
            <div class="question-container" id="questions">
                <!-- 问题将通过JavaScript动态生成 -->
            </div>

            <button type="submit" class="submit-btn"><i class="bi bi-send"></i> 提交测试</button>
        </form>

        <div id="results">
            <h2 class="results-header"><i class="bi bi-graph-up"></i> 测试结果分析</h2>

            <div class="score-summary">
                <div class="score-card">
                    <div class="score-label">总分</div>
                    <div class="score-value" id="total-score">0</div>
                    <div>满分450分</div>
                </div>

                <div class="score-card">
                    <div class="score-label">总症状指数</div>
                    <div class="score-value" id="total-index">0</div>
                    <div>总均分</div>
                </div>

                <div class="score-card">
                    <div class="score-label">阳性项目数</div>
                    <div class="score-value" id="positive-items">0</div>
                    <div>≥2分的项目数</div>
                </div>

                <div class="score-card">
                    <div class="score-label">阳性症状均分</div>
                    <div class="score-value" id="positive-score">0</div>
                    <div>阳性项目平均分</div>
                </div>
            </div>

            <h3>各因子分详情</h3>
            <table class="results-table">
                <thead>
                    <tr>
                        <th>因子名称</th>
                        <th>得分</th>
                        <th>正常范围</th>
                        <th>状态</th>
                        <th>解释说明</th>
                    </tr>
                </thead>
                <tbody id="factor-results">
                    <!-- 因子结果将通过JavaScript动态生成 -->
                </tbody>
            </table>

            <div class="factor-details" id="factor-details">
                <!-- 因子详细解释将通过JavaScript动态生成 -->
            </div>

            <button class="print-btn" onclick="window.print()"><i class="bi bi-printer"></i> 打印测试结果</button>

            <div class="interpretation">
                <h3>结果说明与建议</h3>
                <p>SCL-90量表采用5级评分制，通常因子分超过1.5分即表示可能存在该方面的症状，超过2分表明症状达到中等程度，超过3分表明症状较为严重。</p>
                <p>本测试结果仅供参考，不能作为临床诊断依据。如果您在某些因子上的得分较高，建议关注这些方面的心理健康，并考虑咨询专业心理医生。</p>
                <p>请注意：心理健康是动态变化的，单次测试结果不能完全代表您的心理状态。如有需要，请寻求专业机构的帮助。</p>
            </div>
        </div>

        <footer>
            <p>© 2023 SCL-90症状自评量表测试 | 本测试仅供参考，不作为临床诊断依据</p>
        </footer>
    </div>
    <script>
        // 完整的SCL-90测试项目
        const scl90Questions = [
            "头痛", "神经过敏，心中不踏实", "头脑中有不必要的想法或字句盘旋", "头昏或昏倒", "对异性的兴趣减退",
            "对旁人责备求全", "感到别人能控制您的思想", "责怪别人制造麻烦", "忘记性大", "担心自己的衣饰整齐及仪态的端正",
            "容易烦恼和激动", "胸痛", "害怕空旷的场所或街道", "感到自己的精力下降，活动减慢", "想结束自己的生命",
            "听到旁人听不到的声音", "发抖", "感到大多数人都不可信任", "胃口不好", "容易哭泣",
            "同异性相处时感到害羞不自在", "感到受骗，中了圈套或有人想抓住您", "无缘无故地突然感到害怕", "自己不能控制地大发脾气", "怕单独出门",
            "经常责怪自己", "腰痛", "感到难以完成任务", "感到孤独", "感到苦闷",
            "过分担忧", "对事物不感兴趣", "感到害怕", "您的感情容易受到伤害", "旁人能知道您的私下想法",
            "感到别人不理解您、不同情您", "感到人们对您不友好，不喜欢您", "做事必须做得很慢以保证做得正确", "心跳得很厉害", "恶心或胃部不舒服",
            "感到比不上他人", "肌肉酸痛", "感到有人在监视您、谈论您", "难以入睡", "做事必须反复检查",
            "难以作出决定", "怕乘电车、公共汽车、地铁或火车", "呼吸有困难", "一阵阵发冷或发热", "因为感到害怕而避开某些东西、场合或活动",
            "脑子变空了", "身体发麻或刺痛", "喉咙有梗塞感", "感到前途没有希望", "不能集中注意",
            "感到身体的某一部分软弱无力", "感到紧张或容易紧张", "感到手或脚发重", "想到死亡的事", "吃得太多",
            "当别人看着您或谈论您时感到不自在", "有一些不属于您自己的想法", "有想打人或伤害他人的冲动", "醒得太早", "必须反复洗手、点数目或触摸某些东西",
            "睡得不稳不深", "有想摔坏或破坏东西的冲动", "有一些别人没有的想法或念头", "感到对别人神经过敏", "在商店或电影院等人多的地方感到不自在",
            "感到做任何事情都很困难", "一阵阵恐惧或惊恐", "感到在公共场合吃东西很不舒服", "经常与人争论", "单独一人时神经很紧张",
            "别人对您的成绩没有作出恰当的评价", "即使和别人在一起也感到孤单", "感到坐立不安心神不定", "感到自己没有什么价值", "感到熟悉的东西变成陌生或不像是真的",
            "大叫或摔东西", "害怕会在公共场合昏倒", "感到别人想占您的便宜", "为一些有关性的想法而很苦恼", "您认为应该因为自己的过错而受到惩罚",
            "感到要很快把事情做完", "感到自己的身体有严重问题", "从未感到和其他人很亲近", "感到自己有罪", "感到自己的脑子有毛病"
        ];
        // 因子分类（完整版）
        const factors = {
            "躯体化": [0, 11, 26, 38, 39, 46, 50, 71, 85],
            "强迫症状": [2, 28, 36, 44, 53, 62, 77, 87, 89],
            "人际关系敏感": [5, 20, 33, 35, 66, 68, 82],
            "抑郁": [4, 13, 14, 25, 29, 30, 47, 48, 54, 55, 72, 79, 86],
            "焦虑": [1, 10, 22, 32, 45, 56, 64, 74, 80],
            "敌对": [7, 21, 57, 69, 81, 83],
            "恐怖": [12, 23, 24, 40, 58, 59, 70, 75],
            "偏执": [6, 17, 34, 60, 63, 76, 84],
            "精神病性": [8, 15, 16, 31, 37, 41, 42, 61, 67, 78],
            "其他（饮食睡眠）": [3, 9, 18, 19, 27, 43, 49, 51, 52, 65, 73]
        };
        // 因子详细解释
        const factorExplanations = {
            "躯体化": "主要反映主观的身体不适感，包括心血管、胃肠道、呼吸系统的主诉不适，以及头痛、背痛、肌肉酸痛和焦虑的其他躯体表现。",
            "强迫症状": "主要指那些明知没有必要，但又无法摆脱的无意义的思想、冲动和行为，以及一些比较一般的认知障碍的行为征象。",
            "人际关系敏感": "主要指某些个人不自在与自卑感，特别是在与其他人相比较时更加突出。在人际交往中的自卑感，心神不安，明显不自在，以及人际交流中的自我意识，消极的期待亦是这方面症状的典型原因。",
            "抑郁": "以苦闷的情感与心境为代表性症状，还以生活兴趣的减退，动力缺乏，活力丧失等为特征。还反映出失望，悲观以及与抑郁相联系的认知和躯体方面的感受。",
            "焦虑": "一般指那些烦躁，坐立不安，神经过敏，紧张以及由此产生的躯体征象，如震颤等。测定游离不定的焦虑及惊恐发作是本因子的主要内容。",
            "敌对": "主要从思想，感情及行为三个方面来反映敌对的表现。其项目包括厌烦的感觉，摔物，争论直到不可控制的脾气爆发等各方面。",
            "恐怖": "恐惧的对象包括出门旅行，空旷场地，人群或公共场所和交通工具。此外，还有反映社交恐怖的一些项目。",
            "偏执": "本因子是围绕偏执性思维的基本特征而制订：主要指投射性思维，敌对，猜疑，关系观念，妄想，被动体验和夸大等。",
            "精神病性": "反映各式各样的急性症状和行为，有代表性地视为较隐讳，限定不严的精神病性过程的指征。此外，也可以反映精神病性行为的继发征兆和分裂性生活方式的指征。",
            "其他（饮食睡眠）": "主要反映睡眠及饮食情况。"
        };
        // 动态生成问题
        const questionsContainer = document.getElementById('questions');

        scl90Questions.forEach((question, index) => {
            const questionElement = document.createElement('div');
            questionElement.className = 'question';
            questionElement.innerHTML = `
                <div class="question-number">${index + 1}. ${question}</div>
                <div class="options">
                    <div class="option">
                        <input type="radio" id="q${index}-1" name="q${index}" value="1" required>
                        <label for="q${index}-1">没有</label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q${index}-2" name="q${index}" value="2">
                        <label for="q${index}-2">很轻</label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q${index}-3" name="q${index}" value="3">
                        <label for="q${index}-3">中等</label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q${index}-4" name="q${index}" value="4">
                        <label for="q${index}-4">偏重</label>
                    </div>
                    <div class="option">
                        <input type="radio" id="q${index}-5" name="q${index}" value="5">
                        <label for="q${index}-5">严重</label>
                    </div>
                </div>
            `;
            questionsContainer.appendChild(questionElement);
        });
        // 更新进度
        function updateProgress() {
            const answered = document.querySelectorAll('input[type="radio"]:checked').length;
            document.getElementById('progress').textContent = answered;
            document.getElementById('remaining').textContent = 90 - answered;

            if (answered === 90) {
                document.getElementById('completion-message').style.display = 'block';
            } else {
                document.getElementById('completion-message').style.display = 'none';
            }
        }

        // 添加事件监听器以跟踪进度
        document.querySelectorAll('input[type="radio"]').forEach(radio => {
            radio.addEventListener('change', updateProgress);
        });

        // 处理表单提交
        document.getElementById('scl90-test').addEventListener('submit', function(e) {
            e.preventDefault();

            // 显示加载状态
            document.getElementById('loading').style.display = 'block';
            document.querySelector('.submit-btn').disabled = true;

            // 使用setTimeout模拟计算延迟，让用户感知到处理过程
            setTimeout(() => {
                // 收集所有答案
                const answers = [];
                for (let i = 0; i < scl90Questions.length; i++) {
                    const selectedOption = document.querySelector(`input[name="q${i}"]:checked`);
                    if (selectedOption) {
                        answers.push(parseInt(selectedOption.value));
                    } else {
                        alert(`请回答第 ${i + 1} 题`);
                        // 滚动到未回答的问题
                        document.querySelector(`input[name="q${i}"]`).closest('.question').scrollIntoView({ behavior: 'smooth', block: 'center' });
                        document.getElementById('loading').style.display = 'none';
                        document.querySelector('.submit-btn').disabled = false;
                        return;
                    }
                }

                // 计算总分和因子分
                const totalScore = answers.reduce((sum, score) => sum + score, 0);
                const positiveItems = answers.filter(score => score > 1).length;
                const positiveScore = (totalScore / positiveItems).toFixed(2);
                const totalIndex = (totalScore / 90).toFixed(2);

                // 更新总分显示
                document.getElementById('total-score').textContent = totalScore;
                document.getElementById('total-index').textContent = totalIndex;
                document.getElementById('positive-items').textContent = positiveItems;
                document.getElementById('positive-score').textContent = positiveScore;

                // 计算各因子分
                const factorScores = {};
                for (const [factor, indices] of Object.entries(factors)) {
                    if (indices.length > 0) {
                        const sum = indices.reduce((total, index) => total + answers[index], 0);
                        factorScores[factor] = (sum / indices.length).toFixed(2);
                    } else {
                        factorScores[factor] = "0.00";
                    }
                }

                // 显示结果
                displayResults(factorScores);

                // 隐藏加载状态
                document.getElementById('loading').style.display = 'none';
                document.querySelector('.submit-btn').disabled = false;
            }, 1000); // 1秒延迟
        });

        // 显示测试结果
        function displayResults(factorScores) {
            const resultsDiv = document.getElementById('results');
            const factorResults = document.getElementById('factor-results');
            const factorDetails = document.getElementById('factor-details');

            // 清空之前的结果
            factorResults.innerHTML = '';
            factorDetails.innerHTML = '<h3>各因子详细解释</h3>';

            // 生成因子结果表格
            for (const [factor, score] of Object.entries(factorScores)) {
                const scoreValue = parseFloat(score);
                let status, statusClass, explanation;

                if (scoreValue < 1.5) {
                    status = "正常";
                    statusClass = "score-low";
                    explanation = "该因子得分在正常范围内，无明显症状表现。";
                } else if (scoreValue < 2) {
                    status = "轻微";
                    statusClass = "score-moderate";
                    explanation = "该因子有轻微症状表现，建议关注。";
                } else if (scoreValue < 3) {
                    status = "中等";
                    statusClass = "score-high";
                    explanation = "该因子有中等程度症状，建议寻求专业意见。";
                } else {
                    status = "严重";
                    statusClass = "score-high";
                    explanation = "该因子症状较为明显，建议咨询专业心理医生。";
                }

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${factor}</td>
                    <td>${score}</td>
                    <td>1.0-1.5</td>
                    <td class="${statusClass}">${status}</td>
                    <td>${explanation}</td>
                `;
                factorResults.appendChild(row);

                // 添加因子详细解释
                const explanationDiv = document.createElement('div');
                explanationDiv.className = 'factor-explanation';
                explanationDiv.innerHTML = `
                    <h3>${factor}因子</h3>
                    <p><strong>得分：${score} | 状态：<span class="${statusClass}">${status}</span></strong></p>
                    <p><strong>解释：</strong>${factorExplanations[factor]}</p>
                    <p><strong>说明：</strong>${explanation}</p>
                `;
                factorDetails.appendChild(explanationDiv);
            }

            // 显示结果区域
resultsDiv.style.display = 'block';

            // 滚动到结果区域
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        // 初始化进度显示
        updateProgress();
    </script>
</body>
</html>
